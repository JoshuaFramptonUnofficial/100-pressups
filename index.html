 <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>100 Press-Ups a Day Fundraiser</title>
  <meta name="description" content="Joshua's 100 press-ups a day in September. Watch daily videos & donate to Cancer Research UK." />
  <meta name="robots" content="index, follow" />
  <meta name="author" content="Joshua" />
  <meta name="keywords" content="100 pushups, press-ups, charity, Cancer Research UK, fundraiser, daily pushups, Joshua" />
  <meta name="theme-color" content="#0f1223" />

  <!-- Open Graph / Social (populated dynamically where possible) -->
  <meta property="og:locale" content="en_GB" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="100 Press-Ups a Day Fundraiser" />
  <meta property="og:description" content="Joshua's 100 press-ups a day in September. Watch daily videos & donate to Cancer Research UK." />
  <meta property="og:url" content="" id="og-url" />
  <meta property="og:image" content="" id="og-image" />

  <!-- Twitter card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="100 Press-Ups a Day Fundraiser" />
  <meta name="twitter:description" content="Joshua's 100 press-ups a day in September. Watch daily videos & donate to Cancer Research UK." />
  <meta name="twitter:image" content="" id="twitter-image" />

  <!-- Canonical (will be set dynamically to avoid hardcoded mistakes) -->
  <link rel="canonical" href="" id="canonical-link" />

  <!-- Perf hints for fonts + youtube thumbnails -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://www.youtube-nocookie.com">
  <link rel="preconnect" href="https://i.ytimg.com">

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#0f1223;
      --panel:#171a34;
      --ink:#e8ebff;
      --muted:#9aa3c7;
      --brand:#7c3aed;
      --brand-2:#22d3ee;
      --accent:#10b981;
      --danger:#ef4444;
      --shadow: 0 15px 40px rgba(0,0,0,.45);
      --memorial-start:#6d28d9;
      --memorial-end:#a78bfa;
    }
    *{box-sizing:border-box}
    html,body{min-height:100vh;height:100%}
    body{
      margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";
      color:var(--ink);
      background-color:var(--bg);
      background-image:
        radial-gradient(1200px 600px at 10% -10%, rgba(124,58,237,.25), transparent 60%),
        radial-gradient(800px 400px at 100% 0%, rgba(34,211,238,.25), transparent 50%),
        linear-gradient(180deg, var(--bg), #070712 140%);
      background-repeat:no-repeat;
      background-size:cover;
      overflow-x:hidden;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
      -webkit-overflow-scrolling:touch;
    }

    .container{max-width:1100px;margin:0 auto;padding:24px}

    header{display:flex;gap:16px;align-items:center;justify-content:space-between;flex-wrap:wrap}
    .brand{display:flex;gap:14px;align-items:center}
    .logo{width:42px;height:42px;display:grid;place-items:center;border-radius:12px;background:linear-gradient(135deg,var(--brand),var(--brand-2));box-shadow:var(--shadow)}
    .title h1{margin:0;font-size:clamp(20px,2.4vw,34px)}
    .title p{margin:4px 0 0;color:var(--muted);font-weight:600}

    .cta-row{display:flex;gap:12px;align-items:center}
    .btn{appearance:none;border:none;cursor:pointer;font-weight:800;padding:10px 14px;border-radius:12px;display:inline-flex;align-items:center;gap:8px}
    .btn.primary{background:linear-gradient(135deg,var(--brand),var(--brand-2));color:white;box-shadow:0 8px 24px rgba(124,58,237,.12)}
    .btn.ghost{background:transparent;color:var(--ink);border:1px solid rgba(255,255,255,.06)}

    main{display:grid;grid-template-columns:1.15fr .85fr;gap:20px;margin-top:18px}
    @media (max-width:980px){main{grid-template-columns:1fr}}

    .panel{background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.06);border-radius:18px;box-shadow:var(--shadow)}
    .calendar{padding:18px}
    .cal-header{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:12px}
    .legend{display:flex;gap:12px;align-items:center;color:var(--muted);font-weight:700;font-size:13px}
    .legend .key{width:14px;height:14px;border-radius:4px;display:inline-block;box-shadow:0 6px 18px rgba(0,0,0,.28)}

    /* Grid */
    .grid{display:grid;gap:10px;grid-template-columns:repeat(7,1fr)}
    .dow{color:var(--muted);font-weight:700;text-align:center;padding-bottom:4px}

    /* day square larger padding so text doesn't leak */
    .day{position:relative;min-height:84px;padding:14px;border-radius:12px;overflow:hidden;cursor:pointer;
      background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.01));border:1px solid rgba(255,255,255,.06);
      transition:transform .12s ease,border-color .12s ease,box-shadow .12s ease,background .18s ease;display:flex;flex-direction:column;align-items:flex-start;
    }
    .day:hover{transform:translateY(-3px);border-color:rgba(255,255,255,.16)}
    .day.is-empty{opacity:.45}
    .num{font-weight:800;font-size:16px;z-index:2}
    .day .label{margin-top:auto;font-size:12px;color:var(--muted);opacity:.85}

    .day.has-video{
      background:linear-gradient(135deg,rgba(124,58,237,.14),rgba(34,211,238,.06));
      border:1px solid rgba(124,58,237,.12);
      box-shadow: 0 8px 18px rgba(34,50,80,.18) inset, 0 10px 30px rgba(12,14,24,.45);
      color:var(--ink);
    }
    .day.no-video{
      background:linear-gradient(135deg,rgba(239,68,68,.06),rgba(239,68,68,.02));
      border:1px solid rgba(239,68,68,.08);
      box-shadow:0 6px 16px rgba(240,90,90,.04) inset;
      color:var(--ink);
    }

    .day.has-video::after,.day.no-video::after{content:'';position:absolute;right:8px;bottom:8px;width:18px;height:18px;border-radius:6px;z-index:2}
    .day.has-video::after{background:linear-gradient(135deg,var(--accent),rgba(16,185,129,.7));box-shadow:0 6px 14px rgba(16,185,129,.06)}
    .day.no-video::after{background:linear-gradient(135deg,var(--danger),rgba(239,68,68,.8));box-shadow:0 6px 14px rgba(239,68,68,.04)}

    /* Memorial day bubble */
    .day.memorial::after{content:'';position:absolute;right:8px;bottom:8px;width:18px;height:18px;border-radius:6px;z-index:2;background:linear-gradient(135deg,var(--memorial-start),var(--memorial-end));box-shadow:0 6px 14px rgba(124,58,237,.08)}

    /* Player side */
    .right-col{display:flex;flex-direction:column;gap:12px}
    .player{padding:16px}
    .player-card{padding:16px;border-radius:14px;background:linear-gradient(135deg,rgba(124,58,237,.06),rgba(34,211,238,.04));border:1px solid rgba(255,255,255,.06)}

    .frame{position:relative;aspect-ratio:1/1;width:100%;border-radius:12px;background:#050615;overflow:hidden}
    .frame.shimmer::after{content:"";position:absolute;inset:0;border-radius:12px;background:linear-gradient(120deg,transparent 15%,rgba(255,255,255,.06) 35%,transparent 55%);transform:translateX(-160%);animation:shine 2s linear infinite}
    @keyframes shine{to{transform:translateX(160%)}}
    .placeholder{display:grid;place-items:center;height:100%;color:var(--muted);font-weight:700}

    .meta{display:flex;justify-content:space-between;align-items:center;gap:12px;margin-top:12px}
    .meta small{color:var(--muted)}

    footer{margin:28px 0 8px;color:var(--muted);text-align:center}
    .day:focus{outline:3px solid rgba(124,58,237,.25);outline-offset:3px}

    @media (max-width:520px){
      .grid{gap:8px}
      .day{min-height:60px;padding:10px;border-radius:10px}
      .num{font-size:15px}
    }

    .player-iframe{position:absolute;inset:0;width:100%;height:100%;border:0;display:block}

    /* Floating tube (no wave). Rounded fill that respects rounded corners. */
    .shave-floating{position:fixed;right:18px;bottom:22px;z-index:999;display:flex;align-items:center;gap:12px;pointer-events:auto}
    .shave-tube{width:72px;height:240px;border-radius:40px;padding:10px;background:rgba(255,255,255,0.035);border:1px solid rgba(255,255,255,.06);box-shadow:0 26px 56px rgba(0,0,0,.55);display:flex;align-items:flex-end;justify-content:center;cursor:pointer;position:relative;backdrop-filter:blur(6px);transition:transform .18s ease,box-shadow .18s ease}
    .shave-tube:hover{transform:translateY(-4px);box-shadow:0 36px 72px rgba(0,0,0,.6)}
    .shave-label{position:absolute;top:-36px;left:50%;transform:translateX(-50%);font-weight:900;font-size:14px;color:var(--muted);background:rgba(255,255,255,0.03);padding:6px 12px;border-radius:999px;border:1px solid rgba(255,255,255,.04);box-shadow:0 12px 30px rgba(0,0,0,.45);backdrop-filter:blur(6px)}
    /* haircut emoji with subtle ring */
    .shave-emoji{position:absolute;top:8px;left:50%;transform:translateX(-50%);font-size:18px;line-height:1;display:grid;place-items:center;width:30px;height:30px;border-radius:999px;background:transparent}
    .shave-emoji::after{content:'';position:absolute;inset:-6px;border-radius:999px;box-shadow:0 0 0 3px rgba(124,58,237,.06);opacity:0;transition:opacity .18s ease, transform .18s ease}
    .shave-tube:hover .shave-emoji::after{opacity:1;transform:scale(1.02)}
    /* click hint shown on hover (small and minimal) */
    .click-hint{position:absolute;bottom:-22px;left:50%;transform:translateX(-50%);font-size:12px;color:var(--muted);opacity:0;transition:opacity .18s ease;pointer-events:none}
    .shave-tube:hover .click-hint{opacity:1}

    .tube-track{position:absolute;left:10px;right:10px;top:10px;bottom:10px;border-radius:999px;overflow:hidden;background:linear-gradient(180deg,rgba(0,0,0,.06),rgba(255,255,255,.01))}
    .tube-fill{position:absolute;left:0;right:0;bottom:0;height:0%;border-radius:999px;background:linear-gradient(180deg,var(--brand-2),var(--brand));box-shadow:inset 0 8px 20px rgba(0,0,0,.35);transition:height 900ms cubic-bezier(.2,.9,.3,1)}

    /* floating donation label above the fill (absolute inside tube-track) */
    .current-label{position:absolute;left:50%;transform:translateX(-50%);font-weight:900;font-size:12px;color:var(--muted);background:rgba(0,0,0,0.35);padding:4px 8px;border-radius:6px;border:1px solid rgba(255,255,255,.03);backdrop-filter:blur(4px);pointer-events:none;display:none}

    /* Modal fade (gentle) */
    .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:1200;opacity:0;pointer-events:none;transition:opacity .22s ease}
    .modal-backdrop.visible{opacity:1;pointer-events:auto}
    .modal{width:min(520px,94%);background:rgba(255,255,255,0.02);border-radius:12px;padding:20px;border:1px solid rgba(255,255,255,.06);box-shadow:0 40px 80px rgba(0,0,0,.6);backdrop-filter:blur(8px)}
    .modal h3{margin:0 0 8px 0}
    .modal p{margin:0 0 14px 0;color:var(--muted)}
    .modal .actions{display:flex;gap:8px;justify-content:flex-end;margin-top:12px}

    /* Memorial visual inside modal */
    .memorial-visual{width:96px;height:96px;border-radius:999px;display:grid;place-items:center;font-size:42px;background:linear-gradient(135deg,var(--memorial-start),var(--memorial-end));box-shadow:0 18px 40px rgba(109,40,217,.15);color:white}

    /* Unlock cards spacing */
    .unlock-grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:14px;padding:14px}
    @media (max-width:680px){.unlock-grid{grid-template-columns:1fr}}
    .unlock-card{border-radius:14px;padding:20px;display:flex;gap:16px;align-items:center;background:linear-gradient(135deg,rgba(255,255,255,.02),rgba(255,255,255,.01));border:1px solid rgba(255,255,255,.04);box-shadow:0 16px 36px rgba(4,6,12,.6);transition:transform .14s ease,box-shadow .14s ease;min-height:100px}
    .unlock-card:hover{transform:translateY(-4px);box-shadow:0 28px 56px rgba(4,6,12,.7)}
    .unlock-icon{width:64px;height:64px;border-radius:14px;display:grid;place-items:center;font-weight:900;color:white;flex:0 0 64px;font-size:18px}
    .unlock-info{flex:1}
    .unlock-amount{font-weight:900;font-size:16px}
    .unlock-desc{color:var(--muted);font-weight:700;margin-top:6px;font-size:14px;line-height:1.2}
    .icon-5{background:linear-gradient(135deg,#6ee7b7,#3b82f6)}
    .icon-10{background:linear-gradient(135deg,#f97316,#fb7185)}
    .icon-20{background:linear-gradient(135deg,#f59e0b,#f97316)}
    .icon-50{background:linear-gradient(135deg,#60a5fa,#7c3aed)}
    .icon-75{background:linear-gradient(135deg,#93c5fd,#0ea5a9)}
    .icon-100{background:linear-gradient(135deg,#ef4444,#f43f5e)}

    /* Center the larger explanatory text in unlocks panel to avoid overflow */
    .panel.unlocks h3, .panel.unlocks .muted-note, .panel.unlocks p { text-align:center; }
    .panel.unlocks { padding-bottom:18px; } /* extra breathing room */

    .muted-note{font-weight:600;color:var(--muted);font-size:13px;margin-top:8px}

    /* --- Small legal/precaution note below the video -- subtle by design (low contrast) --- */
    .video-smallprint{font-size:12px;color:rgba(255,255,255,0.14);margin-top:10px;line-height:1.2}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true">
          <svg width="26" height="26" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M7 3c2.5-1.2 5.5 1.2 5 3.8C14 4 17 2 19 5c1.2 1.7.8 4.2-.8 5.6L12 16l-6.2-5.4C4 9 3.6 6.6 4.8 5 5.5 4 6.4 3.4 7 3Z" fill="white" fill-opacity=".95"/>
          </svg>
        </div>
        <div class="title">
          <h1>100 Press-Ups a Day Fundraiser</h1>
          <p>Watch the daily video & support <strong>Cancer Research UK</strong>.</p>
        </div>
      </div>

      <div class="cta-row">
        <a class="btn primary" target="_blank" rel="noopener" href="https://fundraise.cancerresearchuk.org/page/joshuas-giving-page-1070" title="Donate to Cancer Research UK">Donate</a>
        <button class="btn ghost" id="latestBtn" title="Jump to the latest uploaded video">Watch Latest</button>
      </div>
    </header>

    <main>
      <!-- Left column: Calendar -->
      <section class="panel calendar" aria-label="Calendar">
        <div class="cal-header">
          <div>
            <h2 id="monthLabel">September 2025</h2>
            <div class="legend">
              <span class="key" style="background:linear-gradient(135deg, rgba(124,58,237,1), rgba(34,211,238,1)); box-shadow:0 8px 20px rgba(34,50,80,.14)"></span> Video added
              <span class="key" style="background:linear-gradient(135deg, rgba(239,68,68,1), rgba(239,110,110,1)); margin-left:14px"></span> No video yet
            </div>
          </div>
        </div>

        <div class="grid" id="dowRow" aria-hidden="true"></div>
        <div class="grid" id="daysGrid" role="grid" aria-label="September days"></div>
      </section>

      <!-- Right column: player + unlocks -->
      <aside class="right-col">
        <!-- Player Panel -->
        <section class="panel player" aria-label="Video player">
          <div class="player-card">
            <div id="playerFrame" class="frame shimmer" role="region" aria-label="Video player">
              <div id="playerMount" class="player-content" aria-live="polite">
                <div class="placeholder">Select a date to watch the video</div>
              </div>
            </div>

            <!-- subtle legal smallprint below the embed (intentionally low contrast) -->
            <p class="video-smallprint" id="videoSmallprint">Videos are not an accurate measure of pushups done.</p>

            <div class="meta">
              <div>
                <strong id="selectedDateLabel">No date selected</strong>
                <div><small id="statusLabel">Click a day on the calendar to play the video.</small></div>
              </div>
              <div style="display:flex;gap:8px;align-items:center">
                <a class="btn primary" target="_blank" rel="noopener" href="https://fundraise.cancerresearchuk.org/page/joshuas-giving-page-1070">Donate Now</a>
              </div>
            </div>
          </div>
        </section>

        <!-- Donation unlocks informational area (cards) -->
        <section class="panel unlocks" aria-label="Donation unlocks">
          <div>
            <h3>Donation unlocks</h3>
            <p class="muted-note">One-time activations that affect the <strong>next</strong> video. Can be activated multiple times.</p>

            <div class="unlock-grid" role="list">
              <div class="unlock-card" role="listitem">
                <div class="unlock-icon icon-5">£5</div>
                <div class="unlock-info">
                  <div class="unlock-amount">Suit press-ups</div>
                  <div class="unlock-desc">I do my press-ups wearing a suit.</div>
                </div>
              </div>

              <div class="unlock-card" role="listitem">
                <div class="unlock-icon icon-10">£10</div>
                <div class="unlock-info">
                  <div class="unlock-amount">Shout your name</div>
                  <div class="unlock-desc">I shout the donor's name in Bradford before the press-ups.</div>
                </div>
              </div>

              <div class="unlock-card" role="listitem">
                <div class="unlock-icon icon-20">£20</div>
                <div class="unlock-info">
                  <div class="unlock-amount">+100 press-ups</div>
                  <div class="unlock-desc">I add 100 extra press-ups on top of the 100.</div>
                </div>
              </div>

              <div class="unlock-card" role="listitem">
                <div class="unlock-icon icon-50">£50</div>
                <div class="unlock-info">
                  <div class="unlock-amount">5K run</div>
                  <div class="unlock-desc">I run 5K in addition to the press-ups (tracked for proof).</div>
                </div>
              </div>

              <div class="unlock-card" role="listitem">
                <div class="unlock-icon icon-75">£75</div>
                <div class="unlock-info">
                  <div class="unlock-amount">Freezing water</div>
                  <div class="unlock-desc">I perform the pushups in freezing cold water.</div>
                </div>
              </div>

              <div class="unlock-card" role="listitem">
                <div class="unlock-icon icon-100">£100</div>
                <div class="unlock-info">
                  <div class="unlock-amount">500 live</div>
                  <div class="unlock-desc">I do 500 pushups live on stream instead of 100.</div>
                </div>
              </div>
            </div>

            <div class="muted-note">These explain what each unlock does — donors activate them on the fundraising page.</div>
          </div>
        </section>
      </aside>
    </main>

    <footer>
      <p>Built by Joshua for the September 100 pushups challenge. Thank you for supporting life-saving research.</p>
    </footer>
  </div>

  <!-- Floating shave milestone (no wave). Hair emoji + subtle ring + click hint -->
  <div class="shave-floating" aria-hidden="false">
    <div id="shaveTube" class="shave-tube" role="button" aria-haspopup="dialog" aria-label="Shave milestone. Click for details">
      <div class="shave-label">£500</div>
      <div class="shave-emoji" aria-hidden="true">💇‍♂️</div>
      <div class="click-hint" aria-hidden="true">Click</div>

      <div id="tubeTrack" class="tube-track" aria-hidden="true">
        <div id="tubeFill" class="tube-fill" style="height:0%"></div>
        <div id="currentLabel" class="current-label" style="display:none">£0</div>
      </div>
    </div>
  </div>

  <!-- Modal with gentle fade (shave milestone) -->
  <div id="modalBackdrop" class="modal-backdrop" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal" role="document" aria-labelledby="modalTitle">
      <h3 id="modalTitle">£500 shave milestone</h3>
      <p>If we reach £500 by the end of the fundraiser, I will shave my head on live on video. Thank you for all your donations, every little helps.</p>
      <div class="actions">
        <a class="btn primary" href="https://fundraise.cancerresearchuk.org/page/joshuas-giving-page-1070" target="_blank" rel="noopener">Donate now</a>
        <button id="modalOk" class="btn ghost">OK</button>
      </div>
    </div>
  </div>

  <!-- Memorial modal (glassy, same visual language) -->
  <div id="memorialBackdrop" class="modal-backdrop" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal" role="document" aria-labelledby="memorialTitle">
      <div style="display:grid;place-items:center;gap:12px">
        <div class="memorial-visual" aria-hidden="true">🕯️</div>
        <h3 id="memorialTitle">In memory of Charlie Kirk</h3>
        <p class="muted-note">We remember and honour Charlie.</p>
        <div class="actions">
          <button id="memorialOk" class="btn ghost">Close</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    /* =========================
       CONFIGURATION
       ========================= */
    const videosByDate = {
      '2025-09-01': 'https://youtube.com/shorts/2EaHb57-M04?feature=share',
      '2025-09-02': 'https://youtube.com/shorts/6wCqKku0kuU?feature=share',
      '2025-09-03': 'https://youtube.com/shorts/O54byQrUlQ8',
      '2025-09-04': 'https://youtube.com/shorts/rgxkeo5LLts',
      '2025-09-05': 'https://youtube.com/shorts/hyaI_EAw2PI?feature=share',
      '2025-09-06': 'https://youtu.be/35SlBeLvdRY',
      '2025-09-07': 'https://youtube.com/shorts/vAv4QMvGNOA',
      '2025-09-08': 'https://youtube.com/shorts/ciuumtW0mLQ',
      '2025-09-09': 'https://youtube.com/shorts/38BtnzzbQrM?feature=share',
      '2025-09-12': 'https://youtube.com/shorts/A_PYMxoyQxE',
      '2025-09-13': 'https://youtube.com/shorts/pczv-BoAN_M',
      '2025-09-14': 'https://youtube.com/shorts/qpydu9gVqnw',
      '2025-09-15': 'https://youtube.com/shorts/9fqF-CRbLV0',
      '2025-09-16': 'https://youtube.com/shorts/0cO6WnWtu3c',
      '2025-09-17': 'https://youtube.com/shorts/BAwkcX5jr0Q',
     '2025-09-18': 'https://youtube.com/shorts/g1IiReEjtc8',
     '2025-09-19': 'https://youtube.com/shorts/w-3nKJhYE40?feature=share'
    };

    // Memorial dates (explicit ISO strings)
    const memorialDates = new Set([
      '2025-09-10',
      '2025-09-11'
    ]);

    const SHAVE_MILESTONE_AMOUNT = 500;
    const CURRENT_DONATIONS = 125;

    /* -------------------------
       DOM refs
       ------------------------- */
    const monthLabel = document.getElementById('monthLabel');
    const dowRow = document.getElementById('dowRow');
    const daysGrid = document.getElementById('daysGrid');
    const playerFrame = document.getElementById('playerFrame');
    const playerMount = document.getElementById('playerMount');
    const selectedDateLabel = document.getElementById('selectedDateLabel');
    const statusLabel = document.getElementById('statusLabel');
    const latestBtn = document.getElementById('latestBtn');

    const tubeFill = document.getElementById('tubeFill');
    const shaveTube = document.getElementById('shaveTube');
    const tubeTrack = document.getElementById('tubeTrack');
    const currentLabel = document.getElementById('currentLabel');
    const modalBackdrop = document.getElementById('modalBackdrop');
    const modalOk = document.getElementById('modalOk');

    const memorialBackdrop = document.getElementById('memorialBackdrop');
    const memorialOk = document.getElementById('memorialOk');

    const TARGET_YEAR = 2025;
    const TARGET_MONTH = 8; // September (0-indexed)

    /* -------------------------
       YouTube parse/embed (from your reliable snippet)
       ------------------------- */
    function parseYouTubeID(url){
      if(!url || typeof url !== 'string') return null;
      const s = url.trim();
      const m = s.match(/(?:youtu\.be\/|youtube(?:-nocookie)?\.com\/(?:watch\?v=|shorts\/|embed\/))([A-Za-z0-9_-]{11})/);
      if(m && m[1]) return m[1];
      try {
        const u = new URL(s, 'https://example.com');
        const v = u.searchParams.get('v');
        if(v && /^[A-Za-z0-9_-]{11}$/.test(v)) return v;
      } catch(e){}
      const seg = s.split('/').filter(Boolean).pop().split('?')[0];
      if(seg && /^[A-Za-z0-9_-]{11}$/.test(seg)) return seg;
      return null;
    }

    /* -------------------------
       SEO helpers: dynamic meta + JSON-LD injection
       ------------------------- */
    function getLatestDateWithVideo(){ const keys = Object.keys(videosByDate).sort(); return keys.length ? keys[keys.length-1] : null; }

    function setCanonicalAndSocialMeta(){
      try{
        // canonical: default to origin+pathname to avoid hardcoding
        let canonicalLink = document.getElementById('canonical-link') || document.querySelector('link[rel="canonical"]');
        if(!canonicalLink){ canonicalLink = document.createElement('link'); canonicalLink.rel='canonical'; canonicalLink.id='canonical-link'; document.head.appendChild(canonicalLink); }
        canonicalLink.href = window.location.origin + window.location.pathname;

        // set og:url
        const ogurl = document.getElementById('og-url') || document.querySelector('meta[property="og:url"]');
        if(ogurl) ogurl.setAttribute('content', canonicalLink.href);

        // use latest video thumbnail for og/twitter image if available
        const metaOgImage = document.getElementById('og-image');
        const metaTwitterImage = document.getElementById('twitter-image');
        const latest = getLatestDateWithVideo();
        const latestSource = latest ? videosByDate[latest] : null;
        const id = parseYouTubeID(latestSource || '');
        const thumb = id ? (`https://i.ytimg.com/vi/${id}/maxresdefault.jpg`) : '';
        if(thumb){ if(metaOgImage) metaOgImage.setAttribute('content', thumb); if(metaTwitterImage) metaTwitterImage.setAttribute('content', thumb); }
      }catch(e){ /* silent */ }
    }

    function injectPageLD(){
      try{
        // remove if exists
        const existing = document.getElementById('page-ld'); if(existing) existing.remove();
        const ld = {
          "@context":"https://schema.org",
          "@type":"WebPage",
          "name":"100 Press-Ups a Day Fundraiser",
          "description":"Joshua's 100 press-ups a day in September. Watch daily videos & donate to Cancer Research UK.",
          "url": window.location.origin + window.location.pathname,
          "author": { "@type":"Person", "name":"Joshua" },
          "mainEntity": {
            "@type": "Event",
            "name": "100 Press-Ups a Day Fundraiser",
            "startDate": "2025-09-01",
            "endDate": "2025-09-30",
            "location": {"@type":"VirtualLocation","url":"https://fundraise.cancerresearchuk.org/page/joshuas-giving-page-1070"}
          }
        };
        const s = document.createElement('script'); s.type = 'application/ld+json'; s.id = 'page-ld'; s.textContent = JSON.stringify(ld); document.head.appendChild(s);
      }catch(e){}
    }

    function injectVideoLD(iso, source){
      try{
        const existing = document.getElementById('video-ld'); if(existing) existing.remove();
        const id = parseYouTubeID(source||'');
        if(!id) return;
        const embedUrl = `https://www.youtube-nocookie.com/embed/${id}`;
        const watchUrl = `https://www.youtube.com/watch?v=${id}`;
        const ld = {
          "@context":"https://schema.org",
          "@type":"VideoObject",
          "name": `${new Date(iso).toDateString()} — 100 Press-Ups`,
          "description":"Daily pushups video from Joshua's 100 pushups fundraiser. Please note videos are not an accurate measure of pushups done.",
          "thumbnailUrl": [`https://i.ytimg.com/vi/${id}/hqdefault.jpg`],
          "uploadDate": iso,
          "embedUrl": embedUrl,
          "contentUrl": watchUrl,
          "author": {"@type":"Person","name":"Joshua"}
        };
        const s = document.createElement('script'); s.type = 'application/ld+json'; s.id = 'video-ld'; s.textContent = JSON.stringify(ld); document.head.appendChild(s);
      }catch(e){}
    }

    /* -------------------------
       Player builder
       ------------------------- */
    function makePlayerFromSource(source){
      playerFrame.classList.remove('shimmer');
      playerMount.innerHTML = '';
      if(!source){ showPlaceholder(); return; }
      if(typeof source !== 'string'){ playerMount.innerHTML = '<div class="placeholder">Invalid video source</div>'; return; }
      const trimmed = source.trim();
      if(trimmed.startsWith('<') && trimmed.indexOf('iframe') !== -1){
        playerMount.innerHTML = '<div style="position:relative;height:100%;">' + trimmed + '</div>';
        const iframe = playerMount.querySelector('iframe');
        if(iframe){
          iframe.classList.add('player-iframe');
          iframe.removeAttribute('width');
          iframe.removeAttribute('height');
          iframe.setAttribute('allow','accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share');
          iframe.setAttribute('allowfullscreen','');
        }
        return;
      }
      const id = parseYouTubeID(trimmed);
      if(!id){
        playerMount.innerHTML = `<div class="placeholder">Can't parse the YouTube URL. <div style="margin-top:10px"><a target="_blank" rel="noopener" href="${escapeHtml(trimmed)}">Open link</a></div></div>`;
        return;
      }
      const embedUrl = `https://www.youtube-nocookie.com/embed/${id}?rel=0&modestbranding=1&playsinline=1`;
      const iframe = document.createElement('iframe');
      iframe.className = 'player-iframe';
      iframe.src = embedUrl;
      iframe.setAttribute('frameborder','0');
      iframe.setAttribute('allow','accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen');
      iframe.setAttribute('allowfullscreen','');
      iframe.title = 'YouTube video player';
      playerMount.appendChild(iframe);
    }

    function escapeHtml(s){ return String(s).replace(/&/g,'&amp;').replace(/"/g,'&quot;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }
    function showPlaceholder(){ playerMount.innerHTML = '<div class="placeholder">Select a date to watch the video</div>'; playerFrame.classList.add('shimmer'); }

    /* -------------------------
       Calendar rendering
       ------------------------- */
    function pad(n){ return String(n).padStart(2,'0'); }
    function buildDOW(){ const names=['Mon','Tue','Wed','Thu','Fri','Sat','Sun']; dowRow.innerHTML=''; names.forEach(n=>{const el=document.createElement('div');el.className='dow';el.textContent=n;dowRow.appendChild(el);}); }
    function buildCalendar(){
      const year = TARGET_YEAR; const month = TARGET_MONTH;
      monthLabel.textContent = 'September ' + year;
      const first = new Date(year, month, 1);
      const last = new Date(year, month+1, 0);
      daysGrid.innerHTML = '';
      let startDow = first.getDay(); if(startDow === 0) startDow = 7;
      for(let i=1;i<startDow;i++){ const empty=document.createElement('div'); empty.className='day is-empty'; daysGrid.appendChild(empty); }
      for(let d=1; d<=last.getDate(); d++){
        const date = new Date(year, month, d);
        const iso = `${date.getFullYear()}-${pad(date.getMonth()+1)}-${pad(d)}`;
        const cell = document.createElement('div');
        cell.className = 'day';
        cell.innerHTML = `<div class="num">${d}</div>`;
        const isMemorial = memorialDates.has(iso);
        if(isMemorial){
          cell.classList.add('memorial');
          cell.tabIndex = 0;
          cell.setAttribute('role','button');
          cell.setAttribute('aria-label', `${iso} memorial`);
          // click/keyboard open memorial
          cell.addEventListener('click', ()=>openMemorialForDate(iso));
          cell.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' '){ e.preventDefault(); openMemorialForDate(iso); } });
        } else {
          const hasVideo = Boolean(videosByDate[iso]);
          cell.classList.add(hasVideo ? 'has-video' : 'no-video');
          cell.tabIndex = 0;
          cell.setAttribute('role','button');
          cell.setAttribute('aria-label', `${iso} ${hasVideo ? 'has video' : 'no video yet'}`);
          cell.addEventListener('click', ()=>selectDate(iso));
          cell.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' '){ e.preventDefault(); selectDate(iso); } });
        }
        daysGrid.appendChild(cell);
      }
    }

    function selectDate(iso){
      selectedDateLabel.textContent = new Date(iso).toDateString();
      const source = videosByDate[iso];
      if(source){
        statusLabel.textContent = 'Loading…';
        try{ makePlayerFromSource(source); } catch(e){ console.error(e); playerMount.innerHTML = '<div class="placeholder">Video failed to load.</div>'; }
        try{ document.getElementById('playerFrame')?.scrollIntoView({behavior:'smooth', block:'start'}); } catch(e){}
        safeSetHash(iso);
        // SEO: inject video structured data for this specific date
        try{ injectVideoLD(iso, source); } catch(e){}
      } else { statusLabel.textContent = 'No video uploaded yet for this date.'; showPlaceholder(); safeSetHash(iso); }
    }
    function openMemorialForDate(iso){
      // blank the player, show memorial modal
      selectedDateLabel.textContent = new Date(iso).toDateString();
      statusLabel.textContent = 'In memory — no video for this date.';
      showPlaceholder();
      safeSetHash(iso);
      openMemorialModal();
    }
    function safeSetHash(iso){ try{ if(typeof history.replaceState === 'function') history.replaceState(null,'',`#${iso}`); else location.hash = `#${iso}`; }catch(e){} }

    latestBtn.addEventListener('click', ()=>{ const latest = getLatestDateWithVideo(); if(latest) selectDate(latest); else statusLabel.textContent='No videos added yet.'; });

    /* -------------------------
       Shave tube: fill + floating number above top of fill
       ------------------------- */
    function renderShaveTube(){
      const pct = Math.max(0, Math.min(100, (CURRENT_DONATIONS / SHAVE_MILESTONE_AMOUNT) * 100 ));
      tubeFill.style.height = pct + '%';
      tubeFill.style.borderRadius = '999px';
      tubeFill.style.background = (CURRENT_DONATIONS >= SHAVE_MILESTONE_AMOUNT)
        ? 'linear-gradient(180deg,var(--accent), #9ef6d1)'
        : 'linear-gradient(180deg,var(--brand-2), var(--brand))';

      requestAnimationFrame(()=>{ 
        const trackRect = tubeTrack.getBoundingClientRect();
        const trackHeight = Math.max(8, trackRect.height);
        const relY = Math.round(trackHeight * (1 - pct/100)); // px from top of track
        const labelOffset = 18; // distance above the fill
        const topPx = Math.max(6, Math.min(trackHeight - 12, relY - labelOffset));
        currentLabel.style.top = topPx + 'px';
        currentLabel.style.display = 'block';
        currentLabel.textContent = '£' + String(CURRENT_DONATIONS);
      });
    }

    /* -------------------------
       Modal fade in/out (gentle)
       ------------------------- */
    function openModal(){
      modalBackdrop.classList.add('visible');
      modalBackdrop.setAttribute('aria-hidden','false');
    }
    function closeModal(){
      modalBackdrop.classList.remove('visible');
      modalBackdrop.setAttribute('aria-hidden','true');
    }

    function openMemorialModal(){
      memorialBackdrop.classList.add('visible');
      memorialBackdrop.setAttribute('aria-hidden','false');
    }
    function closeMemorialModal(){
      memorialBackdrop.classList.remove('visible');
      memorialBackdrop.setAttribute('aria-hidden','true');
    }

    shaveTube.addEventListener('click', openModal);
    modalOk.addEventListener('click', closeModal);
    modalBackdrop.addEventListener('click',(e)=>{ if(e.target === modalBackdrop) closeModal(); });

    memorialOk.addEventListener('click', closeMemorialModal);
    memorialBackdrop.addEventListener('click',(e)=>{ if(e.target === memorialBackdrop) closeMemorialModal(); });

    /* -------------------------
       Initialization
       ------------------------- */
    buildDOW();
    buildCalendar();
    showPlaceholder();
    setTimeout(renderShaveTube, 200);
    const demoIso = `${TARGET_YEAR}-09-01`;
    if(videosByDate[demoIso]) setTimeout(()=>selectDate(demoIso), 120);
    try { if(location.hash && /^#\d{4}-\d{2}-\d{2}$/.test(location.hash)){ const iso = location.hash.slice(1); const d = new Date(iso); if(!isNaN(+d)){
      // If the hash is a memorial, open memorial modal; otherwise try to select date
      if(memorialDates.has(iso)){ selectedDateLabel.textContent = new Date(iso).toDateString(); statusLabel.textContent = 'In memory — no video for this date.'; showPlaceholder(); openMemorialModal(); safeSetHash(iso); }
      else selectDate(iso);
    } } } catch(e){}

    // SEO init: canonical, OG/Twitter images, and page LD
    setTimeout(()=>{ try{ setCanonicalAndSocialMeta(); injectPageLD(); }catch(e){} }, 250);

    window.addEventListener('resize', ()=>{ setTimeout(renderShaveTube, 120); });
    window.addEventListener('load', ()=>{ setTimeout(renderShaveTube, 300); });
  </script>
</body>
</html>
